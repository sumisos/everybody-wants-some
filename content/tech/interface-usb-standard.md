---
title: "USB 相关知识简单科普"
subTitle: "还有这个雷电口到底是什么来头"
date: 2021-05-23T20:44:46+08:00
tags: ["科技", "USB", "雷电"]
series: ["接口"]
related: true
draft: true
---

## USB 协议性能标准
|目前协议名|曾用协议名|带宽|理论速度\*|
|:-:|:-:|:-:|:-:|
|USB 2.0 Low-Speed|USB 1.0|1.5 Mbps|0.1875 MB/s|
|USB 2.0 Full-Speed|USB 1.1|12 Mbps|1.5 MB/s|
|USB 2.0 High-Speed|USB 2.0|480 Mbps|60 MB/s|
|USB 3.2 Gen1|USB 3.0 / USB 3.1 Gen1|5 Gbps|640 MB/s|
|USB 3.2 Gen2 x1|USB 3.1 / USB 3.1 Gen2|10 Gbps|1280 MB/s|
|USB 3.2 Gen2 x2|USB 3.2|20 Gbps|2560 MB/s|
|USB4 Gen2 x2||20 Gbps|2560 MB/s|
|USB4 Gen3 x2||40 Gbps|5120 MB/s|

> \* 理论速度为什么光看数字低于带宽的 1 / 8，我在《<a href="/tech/network-bottom/#%E7%BD%91%E9%80%9F%E7%9A%84%E8%AE%A1%E7%AE%97%E6%96%B9%E5%BC%8F" target="_blank">网速的计算方式</a>》一节中详细说明过。  

## USB 命名演进过程（USB-IF 真是不干人事）
|最初协议名|第二次改名||第三次改名|目前协议名|
|:-:|:-:|:-:|:-:|:-:|
|USB 1.0||2003 年||USB 2.0 Low-Speed|
|USB 1.1||2003 年||USB 2.0 Full-Speed|
|USB 2.0||2003 年||USB 2.0 High-Speed|
|USB 3.0|2013 年|USB 3.1 Gen1|2019 年|USB 3.2 Gen 1|
|USB 3.1|2013 年|USB 3.1 Gen2|2019 年|USB 3.2 Gen 2 x1|
|USB 3.2|||2019 年|USB 3.2 Gen 2 x2|
|USB4||||USB4|

## USB-IF 起源
1994 年，微软和英特尔倡导发起成立了 USB 开发者论坛（USB Implementers Forum），旨在推进 USB 的技术发展与标准化。  

## 物理接口
![USB](https://i.loli.net/2021/05/23/MPWFIviU2qeYyKm.png)

### Type-A
* Standard Type-A USB 接口  
  * USB 2.0 协议（4 金属触点）  
  * USB 3.0 协议（9 金属触点）：一般是蓝色，很多人教你区分 2.0 和 3.0 看颜色，其实未必准确（我见过青色的，~~我 TM~~），但是看金属触点就靠谱得多了  
* Mini Type-A USB 接口  
* Micro Type-A USB 接口  
  * USB 2.0 协议
  * USB 3.0 协议

除了经典的标准 Type-A 熬死了所有后辈，坚挺到了今天。  
别的 Type-A 都已经死绝了，以前是用在 MP3 / MP4 上。  

> 我很怀疑现在的年轻人是否知道 MP3，不是 `.mp3`，是专门播放 `.mp3` 的硬件。  
> 也许听个歌还有专门的机器对他们来说是一件很难想象的事。  
> 但就是我这代人的童年回忆，我们小学初中哪有什么手机甚至电脑，能玩贪吃蛇就很吊了，几个小伙伴一个魔塔玩一下午很平常的事。  
> 半夜躲在被窝里听 MP3 就是最大的乐子之一。发展到 MP4 可以看点 360p 的*高清*电影，这个时候电子娱乐开始抬头，街上甚至出现了代下歌曲 / 电影的店。  
> 后来还炒过什么 MP5 的概念，再后来出了智能机，就没有然后了，连功能机都没有了。  

### Type-B
* Standard Type-B USB 接口：长得很奇葩，方的，一般出现于打印机上  
  * USB 2.0 协议（4 金属触点）  
  * USB 3.0 协议（9 金属触点，比 2.0 版高一块，但兼容 2.0）  
* Mini Type-B USB 接口（5 金属触点，只有 2.0）：出现于功能机（现在叫老年机）上，一些 MP3 / MP4 也挣扎着活到了这个时代   
* Micro Type-B USB 接口  
  * USB 2.0 协议（5 金属触点）：就是以前老的安卓手机上那种，我还记得我第一部智能机是高中的时候，后来发现我的 USB 口怎么跟别人的不太一样  
  * USB 3.0 协议（10 金属触点）：就是 2.0 版加宽了一块，常见于老式的移动硬盘\*上  

> \* 我以前挂载在树莓派上当微型 NAS 用的那块老希捷就是。  
> 这实属新丐中丐了，树莓派 + 1 T 移动盘，丐到这种程度也不用考虑啥 UPS 了。  
> 结果后来真就遇见一次停电，树莓派屁事没有，硬盘挂了。  
> 上面还有好多好东西，好多天上地下仅此一份的独家记忆，现在想起心还会滴血。  
> 再次强调**数据无价，谨慎操作**。重要文件尽量做好备份和容灾。  

### Type-C
俗称的 USB-C，只有这一种形状，最显著的特点支持正反插。  
好像有人叫华为口，可是这也不是华为发明的啊，甚至都不是华为引进的\*……  

> \* 国内最早用上 Type-C 的手机厂商如果我没记错是下周回国。  
> 没错他们还做过手机，我家还有一部，我大一还是大二用来当过一段时间备用机。  

Type-C 厉害的地方不止正反插实在是太方便了，这种方便只能用「先进性」来形容。  
给人类降低了极大的心智负担，稍微想象一下 Type-A 发明三十年来，全人类加一起总共在「为了给 USB 区分正反面」这件事上浪费了多少时间。  
支持正反插还有个好处是拔插受力是相对均衡的，不管是接口还是插头，使用寿命都比以前的安卓口要长得多。  
并且 Type-C 拥有史无前例的 **24 个金属触点**，这意味着甚至有多的触点用不上。  
如此多 I/O 口带来的是超级强大的功能，兼容 USB 2.0 / USB 3.0 / USB4 / 雷电 3 / 雷电 4 / 100W+ 供电都是小意思。  
但并不是所有 Type-C 都这么吊，实际上市面流通的大部分 Type-C，包括很多手机大厂的原装数据线，都是阉割版的丐版 Type-C。  
全功能 Type-C 要大几百呢，后面讲 USB4 会解释凭什么卖这么贵。  
当然了，也不会也一直这么贵。连资本家都忍不了，卖得贵没用，卖得掉才是资本想要的。  

## 通信协议
注意：本文给协议这个分代是我自己想的，我个人是这样理解的。  
我并没有能力为这个结论的权威性背书，请悉知。  

### 第一代
|起初 - 2003 年|2003 年改名后|带宽|理论速度|
|:-:|:-:|:-:|:-:|
|USB 1.0|USB 2.0 Low-Speed|1.5 Mbps|0.1875 MB/s|
|USB 1.1|USB 2.0 Full-Speed|12 Mbps|1.5 MB/s|
|USB 2.0|USB 2.0 High-Speed|480 Mbps|60 MB/s|

### 第二代
|起初 - 2013 年|2013 年改名后|带宽|理论速度|
|:-:|:-:|:-:|:-:|
|USB 3.0|USB 3.1 Gen1|5 Gbps|640 MB/s|
|USB 3.1|USB 3.1 Gen2|10 Gbps|1280 MB/s|

### 第三代
|2019 年改名之前|目前协议名|带宽|理论速度|
|:-:|:-:|:-:|:-:|
|USB 3.1 Gen1|USB 3.2 Gen 1|5 Gbps|640 MB/s|
|USB 3.1 Gen2|USB 3.2 Gen 2 x1|10 Gbps|1280 MB/s|
|USB 3.2|USB 3.2 Gen 2 x2|20 Gbps|2560 MB/s|

### 神必的雷电协议
英特尔发现 USB 已经被他们玩坏了，就丢下微软找苹果合作开发了强大的 <ruby><rb>雷电</rb><rp>（</rp><rt>Thunderbolt</rt><rp>）</rp></ruby> 协议。  
雷电 1 / 雷电 2 用的 Mini DP，雷电 3 / 雷电 4 才升级到 Type-C 进行一个飞的起。  
雷电协议强到什么程度呢，可以让笔记本外接显卡（显卡坞技术），用雷电口**外接**的显卡进行实时计算并与 CPU 通信。  

想想确实很美，但好多人可能听都没听说过，移动硬盘就算了，显卡还能外接来跑的？  
事实上也是，由于这个技术需要直通 CPU，英特尔在其中收了一笔高昂的专利授权费用，导致支持这个功能的笔记本价格普遍上天。门槛实在太高了，根本没有市场。  
而价格能上天的笔记本就算不是专门的游戏本，打个游戏还是没问题的，反过来其实又用不上外接显卡的雷电协议，这就陷入了 American Chopper Argument Meme 的循环。  

![](https://i.loli.net/2021/05/24/S1rOGL5uD2eqW6g.jpg)

英特尔一看，吗的不对劲了，赶紧带着雷电 3 回 USB-IF 找微软，说：  
「老婆你看，我出去没有光是鬼混，这不给你带了个娃回来。家里的娃不行，这个娃，彳亍！」  
微软一想：反正回来了，算了。凑活过吧，还能离咋地。  
再说这个娃确实牛逼，咱们家的基业算是有希望了。  

于是 USB-IF 在雷电 3 的基础上推出了**免费**的 USB4 协议。  
英特尔自己想赚钱没成，不得已回去赚口碑，表示「给行业和消费者带来了双赢的局面」。  
这就是 USB4 的诞生和「雷电 3 / USB4 互相兼容」的原因。  

然后英特尔一扭头又回去找苹果，说：  
「果妹，上一个娃属实牛逼，帮忙把市场打开了，咱们再生一个赚大钱吧~」  
接着做出了雷电 4，继续搞技术认证，继续收认证费。  
这就是雷电 4 的诞生和「雷电 3 / USB4 / 雷电 4 互相兼容」的原因。  

|功能|雷电 3|USB4|雷电 4|
|:-:|:-:|:-:|:-:|
|兼容 USB 协议规范|USB4|USB4|USB4|
|物理接口型号\*|Type-C|Type-C|Type-C|
|带宽|20 \| 40 Gbps|20 \| 40 Gbps|40 Gbps|
|动态分配带宽|不支持|支持|支持|
|外接显卡|支持|支持|支持|
|强制开启 DMA\* 保护|否|否|是|
|强制支持充电|否|否|是|
|视频传输协议|Display Port 1.2|可选 Display Port 1.4|Display Port 1.4|
|快速充电协议|USB PD 3.0|USB PD 3.0|USB PD 3.0|
|反向供电最小功率|15 W|7.5 W|15 W|

> \* 注意这是一个充分不必要条件：  
> USB4 / 雷电协议一定是 Type-C 接口，但 Type-C 接口未必是 USB4 / 雷电协议。  
> 目前市面上的 Type-C 反而大部分是 USB 3.0（或者说各种 3.2 Gen X）。  
> 
> \* <ruby><rb>直接内存访问</rb><rp>（</rp><rt>Direct Memory Access</rt><rp>）</rp></ruby>：硬件之间不通过 CPU 的数据传输。  
> 减轻了 CPU 的负载，毕竟 CPU 需要管理大量系统中断来分配时间片（我挂过操作系统）；并且不再吃 CPU 的性能瓶颈，能跑多快看 DMA 控制器，跑完才会把总线控制权还给 CPU。  

### 第四代
|协议名|带宽|理论速度|
|:-:|:-:|:-:|
|USB4 Gen2 x2|20 Gbps|2560 MB/s|
|USB4 Gen3 x2|40 Gbps|5120 MB/s|

## 总结
* USB4 只支持 Type-C 接口，所以 USB4 一定是 Type-C，Type-C 就是 USB 的未来  
* 但 Type-C 未必是 USB4，根据目前的市场情况很可能是 USB 3.0  
* 雷电 3 / 雷电 4 / USB4 互相兼容  
* 显卡坞技术想得很美，但长得丑啊  
